<!DOCTYPE html>
<html>
   <head>
      <title>Penny.com</title>
   </head>

   <body>
      <hr>
      Good <span id="ampmSpan"></span> and welcome to
      <strong>Penny.com</strong>
      <hr>

      <h1>Author Search</h1>
      Please enter an author name:
      <input type="text" id="authorInput" autoFocus>
      <hr>

      <p id="resultsParagraph"></p>

      <hr>
      Date and time: <span id="datetimeSpan"></span><br>
      Created by <a href="https://www.cs.princeton.edu/~rdondero">
      Bob Dondero</a>
      <hr>

      <script src=
"https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js">
      </script>

      <!-- <script src="static/jquery.min.js"></script> -->

      <script>

         'use strict';

         function getAmPm()
         {
            let dateTime = new Date();
            let hours = dateTime.getHours();
            let amPm = 'morning';
            if (hours >= 12)
               amPm = 'afternoon';
            $('#ampmSpan').html(amPm);
         }

         function getDateTime()
         {
            let dateTime = new Date();
            $('#datetimeSpan').html(dateTime.toLocaleString());
         }

         function handleResponse(response)
         {
            $('#resultsParagraph').html(response);
         }

         let request = null;

         function getResults()
         {
            let author = $('#authorInput').val();
            author = encodeURIComponent(author);
            let url = '/searchresults?author=' + author

            if (request != null)
               request.abort();

            request = $.ajax(
               {
                  type: 'GET',
                  url: url,
                  success: handleResponse
               }
            );
         }

         function setup()
         {
            getAmPm();
            window.setInterval(getAmPm, 1000);
            getDateTime();
            window.setInterval(getDateTime, 1000);
            $('#authorInput').on('input', getResults);
         }

         $('document').ready(setup);

      </script>
   </body>
</html>
